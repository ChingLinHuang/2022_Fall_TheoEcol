<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 4 - Age-structure population model | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2022 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 4 - Age-structure population model | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://ChingLinHuang.github.io/2022_Fall_TheoEcol/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2022 Fall at National Taiwan University." />
  <meta name="github-repo" content="ChingLinHuang/2022_Fall_TheoEcol" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 4 - Age-structure population model | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2022 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://ChingLinHuang.github.io/2022_Fall_TheoEcol/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Ching-Lin Huang (Andy)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4---discrete-exponential-and-logistic-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course information</a></li>
<li class="chapter" data-level="" data-path="week-2---exponential-population-growth.html"><a href="week-2---exponential-population-growth.html"><i class="fa fa-check"></i>Week 2 - Exponential population growth</a></li>
<li class="chapter" data-level="" data-path="week-3---logistic-population-growth-and-stability-analysis.html"><a href="week-3---logistic-population-growth-and-stability-analysis.html"><i class="fa fa-check"></i>Week 3 - Logistic population growth and stability analysis</a></li>
<li class="chapter" data-level="" data-path="week-4---discrete-exponential-and-logistic-models.html"><a href="week-4---discrete-exponential-and-logistic-models.html"><i class="fa fa-check"></i>Week 4 - Discrete exponential and logistic models</a></li>
<li class="chapter" data-level="" data-path="week-4---age-structure-population-model.html"><a href="week-4---age-structure-population-model.html"><i class="fa fa-check"></i>Week 4 - Age-structure population model</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-4---age-structure-population-model" class="section level1 unnumbered hasAnchor">
<h1>Week 4 - Age-structure population model<a href="week-4---age-structure-population-model.html#week-4---age-structure-population-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this lab section, we will analyze a Leslie matrix using for loops and matrix algebra, compare the results with those obtained via eigen-analysis, and visualize the population dynamics and age distribution.</p>
<p><strong>Part 1 - Analyzing Leslie matrix</strong></p>
<pre class="{r&quot;}"><code># week 5

library(tidyverse)

### Leslie matrix and initial age classes
leslie &lt;- matrix(data = c(0, 1, 5,
                               0.5, 0, 0,
                               0, 0.3, 0),
                      nrow = 3,
                      ncol = 3,
                      byrow = T)

N0 &lt;- c(10, 0, 0)

### for loop and matrix algebra
time &lt;- 50
pop_size &lt;- data.frame(Age1 = numeric(time),
                       Age2 = numeric(time),
                       Age3 = numeric(time))
pop_size[1, ] &lt;- N0

for (i in 2:time) {
  pop_size[i, ] &lt;- leslie %*% t(pop_size[i-1, ])
}

# Total abundance
pop_size$N &lt;- rowSums(pop_size)

head(pop_size)

plot(c(1,time), c(0,265), type = &quot;n&quot;, ann = F)
lines(1:time , pop_size$Age1, col = &quot;red&quot;)
lines(1:time , pop_size$Age2, col = &quot;blue&quot;)
lines(1:time , pop_size$Age3, col = &quot;green&quot;)
legend(&quot;topleft&quot;,
       legend = c(&quot;Age1&quot;, &quot;Age2&quot;, &quot;Age3&quot;),
       col = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;),
       lty = 1)


### Asymptotic growth rate and stable age distribution

asymptotic_growth &lt;- pop_size$N[time]/pop_size$N[time-1]
asymptotic_growth

age_distribution &lt;- pop_size[time, 1:3]/sum(pop_size[time, 1:3])
age_distribution

### Eigen-analysis of the Leslie matrix
EIGEN &lt;- eigen(leslie)
EIGEN
as.numeric(EIGEN$values[1]) # dominant eigenvalue
as.numeric(EIGEN$vectors[, 1] / sum(EIGEN$vectors[, 1])) # corresponding eigenvector</code></pre>
<p>The asymptotic growth rate and stable age distribution obtained from for loops and eigen-analysis are similar.</p>
<p><br></p>
<p><strong>Part 2 - Visualizing stable age distribution</strong></p>
<p><br></p>
<p><strong>Part 3 - In-class exercise: Analyzing population matrix of common teasel</strong></p>
<p><a href="https://en.wikipedia.org/wiki/Dipsacus_fullonum">Common teasel (<em>Dipsacus sylvestris</em>)</a> is a herbaceous plant commonly found in abandoned fields and meadows in North America. It has a complex life cycle consisting of various stages. The seeds may lie dormant for one or two years. Seeds that germinate form small rosettes, which will gradually transit into medium and eventually large rosettes. These rosettes (all three sizes) may remain in the same stage for years before entering the next stage. After undergoing vernalization, large (and a few medium) rosettes will form stalks and flower in the upcoming summer, set seeds once, and die. Occasionally, the flowering plants will produce seeds that directly germinate into small/medium/large rosettes without entering dormancy.</p>
<p>Here is a transition diagram for the teasel. Please convert this diagram into a stage-based transition matrix (Lefkovitch matrix) and derive the asymptotic growth rate <span class="math inline">\(\lambda\)</span> in R.</p>
<p><img src="./Teasel Diagram.png" width= "100%"/></p>
<p><br></p>
<p><strong>Part 5 - COM(P)ADRE: A global database of population matrices</strong></p>
<p><a href="https://compadre-db.org/ExploreDatabase">COM(P)ADRE</a> is an online repository containing matrix population models on hundreds of plants, animals, algae, fungi, bacteria, and viruses around the world, as well as their associated metadata. Take a look at the website: You will be exploring the population dynamics of a species (of your choice) in your assignment!</p>
<p><br></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4---discrete-exponential-and-logistic-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ChingLinHuang/2022_Fall_TheoEcol/05_Week_5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
